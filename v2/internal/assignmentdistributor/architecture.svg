<svg width="1000" height="700" xmlns="http://www.w3.org/2000/svg" font-family="Arial, sans-serif">
    <!-- Definitions for markers (arrowheads) -->
    <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5"
            markerWidth="6" markerHeight="6"
            orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#333" />
        </marker>
    </defs>

    <!-- Styles -->
    <style>
        .component {
            fill: #e1f5fe;
            stroke: #0288d1;
            stroke-width: 2;
            rx: 10;
            ry: 10;
        }
        .component-text {
            font-size: 14px;
            font-weight: bold;
            text-anchor: middle;
            fill: #01579b;
        }
        .flow-text {
            font-size: 12px;
            fill: #333;
            text-anchor: middle;
        }
        .flow-text-small {
            font-size: 11px;
            fill: #555;
            text-anchor: middle;
        }
        .arrow-line {
            stroke: #333;
            stroke-width: 1.5;
            marker-end: url(#arrow);
        }
    </style>

    <!-- Title -->
    <text x="500" y="30" font-size="20" font-weight="bold" text-anchor="middle">Open Match v2 Assignment Distributor Architecture</text>

    <!-- Components -->
    <g id="components">
        <!-- Client Side -->
        <rect x="50" y="100" width="180" height="60" class="component"/>
        <text x="140" y="135" class="component-text">Game Client</text>

        <rect x="50" y="300" width="180" height="60" class="component"/>
        <text x="140" y="335" class="component-text">Matchmaking Queue</text>

        <!-- Core Services -->
        <rect x="410" y="150" width="180" height="60" class="component"/>
        <text x="500" y="185" class="component-text">Open Match Core</text>

        <rect x="410" y="450" width="180" height="60" class="component"/>
        <text x="500" y="475" class="component-text">Assignment Distributor</text>
        <text x="500" y="495" class="component-text">(Google Cloud Pub/Sub)</text>

        <!-- Backend/Logic -->
        <rect x="770" y="100" width="180" height="60" class="component"/>
        <text x="860" y="135" class="component-text">Game Server Manager</text>

        <rect x="770" y="300" width="180" height="60" class="component"/>
        <text x="860" y="335" class="component-text">Director</text>

        <rect x="410" y="350" width="180" height="60" class="component"/>
        <text x="500" y="385" class="component-text">Matchmaking Function</text>
    </g>

    <!-- Arrows and Flow -->
    <g id="flows">
        <!-- 1. Client -> MMQueue -->
        <line x1="175" y1="160" x2="175" y2="300" class="arrow-line"/>
        <text x="190" y="230" class="flow-text" transform="rotate(90 190 230)">1. Matchmaking Req</text>

        <!-- 2. MMQueue -> OM Core -->
        <line x1="230" y1="330" x2="410" y2="175" class="arrow-line"/>
        <text x="320" y="275" class="flow-text" transform="rotate(-40 325 275)">2. Create/Activate Ticket</text>

        <!-- 3. Director -> GS Manager -->
        <line x1="900" y1="300" x2="900" y2="160" class="arrow-line"/>
        <text x="870" y="230" class="flow-text" transform="rotate(90 870 230)">3. Get Server Needs</text>

        <!-- 4. Director -> OM Core -->
        <line x1="770" y1="310" x2="590" y2="175" class="arrow-line"/>
        <text x="670" y="280" class="flow-text" transform="rotate(35 670 280)">4. InvokeMMFs(Profiles)</text>

        <!-- 5. OM Core -> MMF -->
        <line x1="450" y1="210" x2="450" y2="350" class="arrow-line"/>
        <text x="430" y="270" class="flow-text" transform="rotate(90 430 270)">5. Stream Pools</text>

        <!-- 6. MMF -> OM Core -->
        <line x1="550" y1="350" x2="550" y2="210" class="arrow-line"/>
        <text x="560" y="280" class="flow-text" transform="rotate(90 560 280)">6. Stream Matches</text>

        <!-- 7. OM Core -> Director -->
        <line x1="590" y1="200" x2="770" y2="330" class="arrow-line"/>
        <text x="680" y="235" class="flow-text" transform="rotate(35 680 235)">7. Stream Matches</text>

        <!-- 8. Director -> GS Manager -->
        <line x1="800" y1="160" x2="800" y2="300" class="arrow-line"/>
        <text x="780" y="220" class="flow-text" transform="rotate(-90 780 220)">8. Allocate Server</text>

        <!-- 9. Director -> Pub/Sub -->
        <line x1="770" y1="340" x2="590" y2="480" class="arrow-line"/>
        <text x="680" y="395" class="flow-text" transform="rotate(-40 680 395)">9. Publish Assignment</text>

        <!-- 10. Pub/Sub -> MMQueue -->
        <line x1="410" y1="480" x2="230" y2="340" class="arrow-line"/>
        <text x="320" y="400" class="flow-text" transform="rotate(40 320 400)">10. Push Assignment</text>
        
        <!-- 11. MMQueue -> Client -->
        <line x1="100" y1="310" x2="100" y2="160" class="arrow-line"/>
        <text x="90" y="230" class="flow-text" transform="rotate(-90 90 230)">11. Notify Client</text>
    </g>
</svg>
